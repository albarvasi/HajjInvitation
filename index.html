<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hajj Homecoming</title>
  <meta name="description" content="Join us to celebrate Hajj — you are warmly invited." />
  <meta property="og:title" content="Hajj Homecoming" />
  <meta property="og:description" content="Join us to celebrate Hajj — you are warmly invited." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="invite.jpg" />
  <meta name="theme-color" content="#0a3d62" />
  <style>
    html,body{
      margin:0; padding:0; height:100%; width:100%;
      background:#000;
      display:flex; justify-content:center; align-items:center;
    }
    img{width:100%; height:100%; object-fit:contain; background:#000}
    #audioBtn{
      position:fixed; bottom:20px; right:20px;
      background:#0a3d62; color:#fff; border:0; border-radius:999px;
      padding:12px 18px; font-weight:600; cursor:pointer;
    }
    #autoplayNote{
      position:fixed; bottom:60px; right:20px;
      color:#fff; font-size:12px;
    }
  </style>
</head>
<body>
  <img src="invite.jpg" alt="Invitation card" />

  <button id="audioBtn" aria-pressed="false"><span id="audioIcon">▶️</span> <span id="audioText">Play Labbaik</span></button>
  <span id="autoplayNote" hidden>Tip: Tap play — browsers block auto‑play with sound.</span>

  <audio id="bgm" src="labbaik.mp3" preload="auto" loop playsinline crossorigin="anonymous"></audio>

  <script>
    const audio = document.getElementById('bgm');
    const btn = document.getElementById('audioBtn');
    const icon = document.getElementById('audioIcon');
    const text = document.getElementById('audioText');
    const note = document.getElementById('autoplayNote');

    function updateUI(){
      const playing = !audio.paused;
      icon.textContent = playing ? '⏸️' : '▶️';
      text.textContent = playing ? 'Pause Labbaik' : 'Play Labbaik';
      btn.setAttribute('aria-pressed', playing ? 'true' : 'false');
    }

    async function attemptAutoplay(){
      try{
        audio.muted = true;
        await audio.play();
        audio.pause();
        audio.currentTime = 0;
        audio.muted = false;
        note.hidden = false;
      }catch(err){
        note.hidden = false;
      }
    }
    attemptAutoplay();

    btn.addEventListener('click', async ()=>{
      try{
        if(audio.paused){ await audio.play(); }
        else{ audio.pause(); }
      }catch(err){ console.error(err); }
      updateUI();
    });

    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden){ audio.pause(); }
      updateUI();
    });

    // initial UI sync
    updateUI();
  </script>
</body>
</html>
